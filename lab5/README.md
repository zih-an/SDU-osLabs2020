# 解题
使用消息队列解决理发店问题

## 题意
- 3个理发椅子；3个理发师；4个顾客坐等的理发沙发；等候室可容纳13位顾客
- 顾客发现理发店中顾客已满：超过20人，不进入，直接离开
- 理发师有空就为沙发上等待时间最长的顾客理发，空出的沙发让等候室中等待时间最长的顾客就坐；
- 顾客理完发后，可向任何一位理发师付款。但只有一本现金登记册，任一时刻只能记录一个顾客的付款。理发师在没有顾客的时候坐在理发椅子上睡眠。

## 思路
### 消息队列的设置
- 现金登记册队列 --201
- 椅子队列 --202
- 沙发队列 --203
- 等候室队列 --204
- 请求队列 --205
- 反馈队列 --206


### 程序安排
- 头文件及实现：ipc.h/ipc.c
- 理发师：barber.c，输入第二个参数代表号数
    + 从椅子取消息（不阻塞），若成功去理发
        * sleep一定秒数表示理发中
        * 给该顾客发送表示理发结束
    + 从现金登记册队列取消息（不阻塞），若成功去收款
        * 向请求队列请求收款
        * 收到消息表示收款结束（阻塞）
        * 给相应顾客发送表示可以离店
        * 请求调整座位
    + 都不成功去睡觉（else）
- 顾客：customer.c，运行多个进程代表多个顾客
    + 向控制程序发消息
    + 收到控制程序反馈（阻塞），入座/离开
    + 收到理发师消息准备付款（阻塞）
    + 给现金登记册队列发消息要付款
    + 收到反馈队列消息则离店（阻塞）
- 控制程序：control.c
    + 记录现金登记册、椅子、沙发、等候室使用的个数情况（count）
    + 响应顾客发出的消息（不阻塞取）
        * 先挪位置
        * 通过记录的使用个数情况给相应队列发送消息
        * 更新使用个数情况（count）
        * 给顾客发送：入座/离开
    + 理发师：循环处理当前的座位状况（不阻塞取）
        * 挪位置
    + 理发师：收款（不阻塞取）
        * sleep，发送收款成功
